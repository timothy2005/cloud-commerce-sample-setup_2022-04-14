"use strict";(self.webpackChunkspartacusstore=self.webpackChunkspartacusstore||[]).push([[124],{9124:(Ee,q,p)=>{p.r(q),p.d(q,{UserProfileModule:()=>Fe});var e=p(7716),m=p(8583),g=p(5987),s=p(647),d=p(8984),C=p(6215),G=p(5319),Y=p(9112),E=p(8049),Z=p(8307),A=p(8002),R=p(5435),b=p(3190),f=p(5594),i=p(3679);function Q(t,a){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"div",8),e._UZ(2,"cx-spinner"),e.qZA(),e.qZA())}function j(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"div",10),e.TgZ(2,"p",11),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e.qZA(),e.TgZ(5,"div",10),e.TgZ(6,"div",12),e.TgZ(7,"button",13),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).closeAccount()}),e._uU(8),e.ALo(9,"cxTranslate"),e.qZA(),e.TgZ(10,"button",14),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).dismissModal()}),e._uU(11),e.ALo(12,"cxTranslate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,3,"closeAccount.confirmAccountClosureMessage")," "),e.xp6(5),e.hij(" ",e.lcZ(9,5,"closeAccount.closeMyAccount")," "),e.xp6(3),e.hij(" ",e.lcZ(12,7,"common.cancel")," "))}function X(t,a){if(1&t){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return e.CHM(o),e.oxw().dismissModal()}),e.ALo(6,"cxTranslate"),e.TgZ(7,"span",4),e._UZ(8,"cx-icon",5),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,Q,3,0,"div",6),e.ALo(10,"async"),e.YNc(11,j,13,9,"ng-template",null,7,e.W1O),e.BQk()}if(2&t){const o=e.MAs(12),r=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,5,"closeAccount.confirmAccountClosure")," "),e.xp6(2),e.uIk("aria-label",e.lcZ(6,7,"common.close")),e.xp6(3),e.Q6J("type",r.iconTypes.CLOSE),e.xp6(1),e.Q6J("ngIf",e.lcZ(10,9,r.isLoading$))("ngIfElse",o)}}const T=function(){return{cxRoute:"home"}};function z(t,a){1&t&&e._UZ(0,"cx-spinner",7)}const I=function(){return{cxRoute:"login"}};function B(t,a){if(1&t&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.code),e.xp6(1),e.hij(" ",o.name," ")}}function W(t,a){if(1&t&&(e.TgZ(0,"label"),e._UZ(1,"input",26),e.TgZ(2,"span",21),e._uU(3),e.qZA(),e.qZA()),2&t){const o=a.ngIf,r=e.oxw(2);e.xp6(1),e.Q6J("checked",r.isConsentGiven(o.consent)),e.xp6(2),e.hij(" ",o.template," ")}}const H=function(){return{cxRoute:"termsAndConditions"}};function V(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"section",2),e.TgZ(1,"div",3),e.TgZ(2,"div",4),e.TgZ(3,"div",5),e.TgZ(4,"form",6),e.NdJ("ngSubmit",function(){return e.CHM(o),e.oxw().submitForm()}),e.TgZ(5,"div",7),e.TgZ(6,"label"),e.TgZ(7,"span",8),e._uU(8),e.ALo(9,"cxTranslate"),e.qZA(),e.TgZ(10,"select",9),e.TgZ(11,"option",10),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e.YNc(14,B,2,2,"option",11),e.ALo(15,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",7),e.TgZ(17,"label"),e.TgZ(18,"span",8),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",12),e.ALo(22,"cxTranslate"),e._UZ(23,"cx-form-errors",13),e.qZA(),e.qZA(),e.TgZ(24,"div",7),e.TgZ(25,"label"),e.TgZ(26,"span",8),e._uU(27),e.ALo(28,"cxTranslate"),e.qZA(),e._UZ(29,"input",14),e.ALo(30,"cxTranslate"),e._UZ(31,"cx-form-errors",13),e.qZA(),e.qZA(),e.TgZ(32,"div",7),e.TgZ(33,"label"),e.TgZ(34,"span",8),e._uU(35),e.ALo(36,"cxTranslate"),e.qZA(),e._UZ(37,"input",15),e.ALo(38,"cxTranslate"),e._UZ(39,"cx-form-errors",13),e.qZA(),e.qZA(),e.TgZ(40,"div",7),e.TgZ(41,"label"),e.TgZ(42,"span",8),e._uU(43),e.ALo(44,"cxTranslate"),e.qZA(),e._UZ(45,"input",16),e.ALo(46,"cxTranslate"),e._UZ(47,"cx-form-errors",13),e.qZA(),e.qZA(),e.TgZ(48,"div",7),e.TgZ(49,"label"),e.TgZ(50,"span",8),e._uU(51),e.ALo(52,"cxTranslate"),e.qZA(),e._UZ(53,"input",17),e.ALo(54,"cxTranslate"),e._UZ(55,"cx-form-errors",13),e.qZA(),e.qZA(),e.TgZ(56,"div",7),e.TgZ(57,"div",18),e.YNc(58,W,4,2,"label",19),e.ALo(59,"async"),e.qZA(),e.qZA(),e.TgZ(60,"div",7),e.TgZ(61,"div",18),e.TgZ(62,"label"),e._UZ(63,"input",20),e.TgZ(64,"span",21),e._uU(65),e.ALo(66,"cxTranslate"),e.TgZ(67,"a",22),e.ALo(68,"cxUrl"),e._uU(69),e.ALo(70,"cxTranslate"),e.qZA(),e.qZA(),e._UZ(71,"cx-form-errors",13),e.qZA(),e.qZA(),e.qZA(),e.TgZ(72,"button",23),e._uU(73),e.ALo(74,"cxTranslate"),e.qZA(),e.TgZ(75,"a",24),e.ALo(76,"cxUrl"),e._uU(77),e.ALo(78,"cxTranslate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.xp6(4),e.Q6J("formGroup",o.registerForm),e.xp6(4),e.Oqu(e.lcZ(9,27,"register.title")),e.xp6(4),e.hij(" ",e.lcZ(13,29,"register.selectTitle")," "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(15,31,o.titles$)),e.xp6(5),e.Oqu(e.lcZ(20,33,"register.firstName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,35,"register.firstName.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("firstName")),e.xp6(4),e.Oqu(e.lcZ(28,37,"register.lastName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(30,39,"register.lastName.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("lastName")),e.xp6(4),e.Oqu(e.lcZ(36,41,"register.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(38,43,"register.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("email")),e.xp6(4),e.Oqu(e.lcZ(44,45,"register.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(46,47,"register.password.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("password")),e.xp6(4),e.Oqu(e.lcZ(52,49,"register.confirmPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(54,51,"register.confirmPassword.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("passwordconf")),e.xp6(3),e.Q6J("ngIf",e.lcZ(59,53,o.anonymousConsent$)),e.xp6(7),e.hij(" ",e.lcZ(66,55,"register.confirmThatRead")," "),e.xp6(2),e.Q6J("routerLink",e.lcZ(68,57,e.DdM(67,H))),e.xp6(2),e.hij(" ",e.lcZ(70,59,"register.termsAndConditions")," "),e.xp6(2),e.Q6J("control",o.registerForm.get("termsandconditions")),e.xp6(2),e.hij(" ",e.lcZ(74,61,"register.register")," "),e.xp6(2),e.Q6J("routerLink",e.lcZ(76,63,e.DdM(68,I))),e.xp6(2),e.Oqu(e.lcZ(78,65,"register.signIn"))}}function K(t,a){1&t&&(e.TgZ(0,"div",27),e._UZ(1,"cx-spinner"),e.qZA())}function ee(t,a){1&t&&e._UZ(0,"cx-spinner",2)}function oe(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"form",3),e.NdJ("ngSubmit",function(){const c=e.CHM(o).ngIf;return e.oxw().onSubmit(c)}),e.TgZ(1,"label"),e.TgZ(2,"span",4),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e._UZ(5,"input",5),e.ALo(6,"cxTranslate"),e._UZ(7,"cx-form-errors",6),e.qZA(),e.TgZ(8,"label"),e.TgZ(9,"span",4),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA(),e._UZ(12,"input",7),e.ALo(13,"cxTranslate"),e._UZ(14,"cx-form-errors",6),e.qZA(),e.TgZ(15,"button",8),e._uU(16),e.ALo(17,"cxTranslate"),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("formGroup",o.form),e.xp6(3),e.Oqu(e.lcZ(4,9,"register.newPassword")),e.xp6(2),e.s9C("placeholder",e.lcZ(6,11,"register.password.placeholder")),e.xp6(2),e.Q6J("control",o.form.get("password")),e.xp6(3),e.Oqu(e.lcZ(11,13,"register.passwordMinRequirements")),e.xp6(2),e.s9C("placeholder",e.lcZ(13,15,"register.confirmPassword.placeholder")),e.xp6(2),e.Q6J("control",o.form.get("passwordConfirm")),e.xp6(1),e.Q6J("disabled",o.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(17,17,"register.resetPassword")," ")}}function te(t,a){1&t&&e._UZ(0,"cx-spinner",9)}function re(t,a){1&t&&e._UZ(0,"cx-spinner",9)}function se(t,a){1&t&&e._UZ(0,"cx-spinner",12)}function ne(t,a){if(1&t&&(e.TgZ(0,"option",13),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.code),e.xp6(1),e.hij(" ",o.name," ")}}let ie=(()=>{class t{constructor(o,r,n,c,l,u){this.modalService=o,this.authService=r,this.globalMessageService=n,this.routingService=c,this.translationService=l,this.userProfile=u,this.iconTypes=d.e1G,this.isLoading$=new C.X(!1)}ngOnInit(){this.isLoggedIn$=this.authService.isUserLoggedIn()}onSuccess(){this.dismissModal(),this.translationService.translate("closeAccount.accountClosedSuccessfully").pipe((0,E.P)()).subscribe(o=>{this.globalMessageService.add(o,s.xUg.MSG_TYPE_CONFIRMATION)}),this.routingService.go({cxRoute:"home"})}onError(){this.dismissModal(),this.translationService.translate("closeAccount.accountClosedFailure").pipe((0,E.P)()).subscribe(o=>{this.globalMessageService.add(o,s.xUg.MSG_TYPE_ERROR)})}dismissModal(o){this.modalService.dismissActiveModal(o)}closeAccount(){this.isLoading$.next(!0),this.userProfile.close().subscribe({next:()=>{this.onSuccess(),this.isLoading$.next(!1)},error:()=>{this.onError(),this.isLoading$.next(!1)}})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(d.Z7U),e.Y36(s.e80),e.Y36(s.IWp),e.Y36(s.Znh),e.Y36(s.D7D),e.Y36(f.aT))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-close-account-modal"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"modal-header","cx-dialog-header"],[1,"modal-title"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[4,"ngIf","ngIfElse"],["loaded",""],[1,"cx-spinner"],[1,"modal-body"],[1,"cx-row"],[1,"cx-confirmation"],[1,"cx-btn-group"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-block","btn-secondary",3,"click"]],template:function(o,r){1&o&&(e.YNc(0,X,13,11,"ng-container",0),e.ALo(1,"async")),2&o&&e.Q6J("ngIf",e.lcZ(1,1,r.isLoggedIn$))},directives:[m.O5,d.oJW,d.ORR],pipes:[m.Ov,s.X$D],encapsulation:2,changeDetection:0}),t})(),ae=(()=>{class t{constructor(o){this.modalService=o}openModal(){this.modal=this.modalService.open(ie,{centered:!0}).componentInstance}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(d.Z7U))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-close-account"]],decls:11,vars:10,consts:[[1,"col-lg-8","col-md-9"],[1,"row","cx-btn-group"],[1,"col-sm-3"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"col-sm-6"],[1,"btn","btn-primary",3,"click"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"a",3),e.ALo(4,"cxUrl"),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"button",5),e.NdJ("click",function(){return r.openModal()}),e._uU(9),e.ALo(10,"cxTranslate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("routerLink",e.lcZ(4,3,e.DdM(9,T))),e.xp6(2),e.Oqu(e.lcZ(6,5,"common.cancel")),e.xp6(4),e.hij(" ",e.lcZ(10,7,"closeAccount.closeMyAccount")," "))},directives:[g.yS],pipes:[s.l2T,s.X$D],encapsulation:2,changeDetection:0}),t})(),ce=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{CloseAccountComponent:{component:ae,guards:[s.a1M]}}})],imports:[[m.ez,g.Bz,s.bhT,s.LUR,d.QX1,d.Fme]]}),t})(),P=(()=>{class t{constructor(o,r,n,c){this.userPasswordService=o,this.routingService=r,this.authConfigService=n,this.globalMessage=c,this.busy$=new C.X(!1),this.isUpdating$=this.busy$.pipe((0,Z.b)(l=>!0===l?this.form.disable():this.form.enable())),this.form=new i.cw({userEmail:new i.NI("",[i.kI.required,d.kal.emailValidator])})}requestEmail(){this.form.valid?(this.busy$.next(!0),this.userPasswordService.requestForgotPasswordEmail(this.form.value.userEmail).subscribe({next:()=>this.onSuccess(),error:o=>this.onError(o)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetEmailSent"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(o){this.busy$.next(!1)}redirect(){this.authConfigService.getOAuthFlow()===s.C8C.ResourceOwnerPasswordFlow&&this.routingService.go({cxRoute:"login"})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.dSP),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),le=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.requestEmail()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(P))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-forgot-password"]],decls:17,vars:22,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["type","email","formControlName","userEmail",1,"form-control",3,"placeholder"],[3,"control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,z,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label"),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"a",5),e.ALo(11,"cxUrl"),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e.TgZ(14,"button",6),e._uU(15),e.ALo(16,"cxTranslate"),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngIf",e.lcZ(1,9,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,11,"forgottenPassword.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,13,"forgottenPassword.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("userEmail")),e.xp6(1),e.Q6J("routerLink",e.lcZ(11,15,e.DdM(21,I))),e.xp6(2),e.Oqu(e.lcZ(13,17,"common.cancel")),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(16,19,"common.submit")," "))},directives:[m.O5,i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,d.Ahv,g.yS,d.ORR],pipes:[m.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),t})(),de=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ForgotPasswordComponent:{component:le,guards:[s.aOY],providers:[{provide:P,useClass:P,deps:[f.LL,s.Znh,s.dSP,s.IWp]}]}}})],imports:[[m.ez,i.UX,g.Bz,s.bhT,s.LUR,d.Fym,d.Fme]]}),t})(),ue=(()=>{class t{constructor(o,r,n,c,l,u,v){this.userRegister=o,this.globalMessageService=r,this.fb=n,this.router=c,this.anonymousConsentsService=l,this.anonymousConsentsConfig=u,this.authConfigService=v,this.isLoading$=new C.X(!1),this.subscription=new G.w,this.registerForm=this.fb.group({titleCode:[""],firstName:["",i.kI.required],lastName:["",i.kI.required],email:["",[i.kI.required,d.kal.emailValidator]],password:["",[i.kI.required,d.kal.passwordValidator]],passwordconf:["",i.kI.required],newsletter:new i.NI({value:!1,disabled:this.isConsentRequired()}),termsandconditions:[!1,i.kI.requiredTrue]},{validators:d.kal.passwordsMustMatch("password","passwordconf")})}ngOnInit(){var o,r,n;this.titles$=this.userRegister.getTitles().pipe((0,A.U)(l=>l.sort(d.ke7))),this.subscription.add(this.globalMessageService.get().pipe((0,R.h)(l=>!!Object.keys(l).length)).subscribe(l=>{const u=l&&l[s.xUg.MSG_TYPE_ERROR];u&&u.some(v=>"This field is required."===v)&&(this.globalMessageService.remove(s.xUg.MSG_TYPE_ERROR),this.globalMessageService.add({key:"register.titleRequired"},s.xUg.MSG_TYPE_ERROR))}));const c=null!==(n=null===(r=null===(o=this.anonymousConsentsConfig)||void 0===o?void 0:o.anonymousConsents)||void 0===r?void 0:r.registerConsent)&&void 0!==n?n:"";this.anonymousConsent$=(0,Y.aj)([this.anonymousConsentsService.getConsent(c),this.anonymousConsentsService.getTemplate(c)]).pipe((0,A.U)(([l,u])=>({consent:l,template:(null==u?void 0:u.description)?u.description:""}))),this.subscription.add(this.registerForm.get("newsletter").valueChanges.subscribe(()=>{this.toggleAnonymousConsent()}))}submitForm(){this.registerForm.valid?this.registerUser():this.registerForm.markAllAsTouched()}registerUser(){this.isLoading$.next(!0),this.userRegister.register(this.collectDataFromRegisterForm(this.registerForm.value)).subscribe({next:()=>this.onRegisterUserSuccess(),complete:()=>this.isLoading$.next(!1)})}titleSelected(o){this.registerForm.controls.titleCode.setValue(o.code)}collectDataFromRegisterForm(o){const{firstName:r,lastName:n,email:c,password:l,titleCode:u}=o;return{firstName:r,lastName:n,uid:c.toLowerCase(),password:l,titleCode:u}}isConsentGiven(o){return this.anonymousConsentsService.isConsentGiven(o)}isConsentRequired(){var o,r,n,c;const l=null===(r=null===(o=this.anonymousConsentsConfig)||void 0===o?void 0:o.anonymousConsents)||void 0===r?void 0:r.requiredConsents,u=null===(c=null===(n=this.anonymousConsentsConfig)||void 0===n?void 0:n.anonymousConsents)||void 0===c?void 0:c.registerConsent;return!(!l||!u)&&l.includes(u)}onRegisterUserSuccess(){this.authConfigService.getOAuthFlow()===s.C8C.ResourceOwnerPasswordFlow&&this.router.go("login"),this.globalMessageService.add({key:"register.postRegisterMessage"},s.xUg.MSG_TYPE_CONFIRMATION)}toggleAnonymousConsent(){var o,r;const n=null===(r=null===(o=this.anonymousConsentsConfig)||void 0===o?void 0:o.anonymousConsents)||void 0===r?void 0:r.registerConsent;n&&(Boolean(this.registerForm.get("newsletter").value)?this.anonymousConsentsService.giveConsent(n):this.anonymousConsentsService.withdrawConsent(n))}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(f.zm),e.Y36(s.IWp),e.Y36(i.qu),e.Y36(s.Znh),e.Y36(s.NpW),e.Y36(s.k0m),e.Y36(s.dSP))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-register"]],decls:4,vars:4,consts:[["class","cx-page-section container",4,"ngIf","ngIfElse"],["loading",""],[1,"cx-page-section","container"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"cx-section"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"label-content"],["formControlName","titleCode",1,"form-control"],["selected","","value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","text","name","firstname","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["type","text","name","lastname","formControlName","lastName",1,"form-control",3,"placeholder"],["type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],["type","password","name","password","formControlName","password",1,"form-control",3,"placeholder"],["type","password","name","confirmpassword","formControlName","passwordconf",1,"form-control",3,"placeholder"],[1,"form-check"],[4,"ngIf"],["type","checkbox","name","termsandconditions","formControlName","termsandconditions"],[1,"form-check-label"],["target","_blank",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary"],[1,"cx-login-link","btn-link",3,"routerLink"],[3,"value"],["type","checkbox","name","newsletter","formControlName","newsletter",1,"form-check-input",3,"checked"],[1,"cx-spinner"]],template:function(o,r){if(1&o&&(e.YNc(0,V,79,69,"section",0),e.ALo(1,"async"),e.YNc(2,K,2,0,"ng-template",null,1,e.W1O)),2&o){const n=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,r.isLoading$))("ngIfElse",n)}},directives:[m.O5,i._Y,i.JL,i.sg,i.EJ,i.JJ,i.u,i.YN,i.Kr,m.sg,i.Fj,d.Ahv,i.Wl,g.yS,d.ORR],pipes:[m.Ov,s.X$D,s.l2T],encapsulation:2}),t})(),pe=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{RegisterCustomerComponent:{component:ue,guards:[s.aOY]}}})],imports:[[m.ez,i.UX,g.Bz,s.bhT,s.LUR,d.Fme,d.Fym]]}),t})(),y=(()=>{class t{constructor(o,r,n){this.userPasswordService=o,this.routingService=r,this.globalMessage=n,this.busy$=new C.X(!1),this.isUpdating$=this.busy$.pipe((0,Z.b)(c=>!0===c?this.form.disable():this.form.enable())),this.resetToken$=this.routingService.getRouterState().pipe((0,A.U)(c=>c.state.queryParams.token)),this.form=new i.cw({password:new i.NI("",[i.kI.required,d.kal.passwordValidator]),passwordConfirm:new i.NI("",i.kI.required)},{validators:d.kal.passwordsMustMatch("password","passwordConfirm")})}resetPassword(o){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const r=this.form.get("password").value;this.userPasswordService.reset(o,r).subscribe({next:()=>this.onSuccess(),error:n=>this.onError(n)})}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(o){var r,n;this.busy$.next(!1),(null!==(n=null===(r=o)||void 0===r?void 0:r.details)&&void 0!==n?n:[]).forEach(c=>{c.message&&this.globalMessage.add({raw:c.message},s.xUg.MSG_TYPE_ERROR)})}redirect(){this.routingService.go({cxRoute:"login"})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),me=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.token$=this.service.resetToken$}onSubmit(o){this.service.resetPassword(o)}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-reset-password"]],hostAttrs:[1,"user-form"],decls:4,vars:6,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"overlay"],[3,"formGroup","ngSubmit"],[1,"label-content"],["type","password","formControlName","password",1,"form-control",3,"placeholder"],[3,"control"],["type","password","formControlName","passwordConfirm",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-primary",3,"disabled"]],template:function(o,r){1&o&&(e.YNc(0,ee,1,0,"cx-spinner",0),e.ALo(1,"async"),e.YNc(2,oe,18,19,"form",1),e.ALo(3,"async")),2&o&&(e.Q6J("ngIf",e.lcZ(1,2,r.isUpdating$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,r.token$)))},directives:[m.O5,d.ORR,i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,d.Ahv],pipes:[m.Ov,s.X$D],encapsulation:2,changeDetection:0}),t})(),fe=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ResetPasswordComponent:{component:me,guards:[s.aOY],providers:[{provide:y,useClass:y,deps:[f.LL,s.Znh,s.IWp]}]}}})],imports:[[m.ez,i.u5,i.UX,g.Bz,s.LUR,d.Fym,d.Fme]]}),t})(),S=(()=>{class t{constructor(o,r,n,c,l){this.userEmail=o,this.routingService=r,this.globalMessageService=n,this.authService=c,this.authRedirectService=l,this.busy$=new C.X(!1),this.isUpdating$=this.busy$.pipe((0,Z.b)(u=>!0===u?this.form.disable():this.form.enable())),this.form=new i.cw({email:new i.NI("",[i.kI.required,d.kal.emailValidator]),confirmEmail:new i.NI("",[i.kI.required]),password:new i.NI("",[i.kI.required])},{validators:d.kal.emailsMustMatch("email","confirmEmail")})}save(){var o,r;if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const n=null===(o=this.form.get("confirmEmail"))||void 0===o?void 0:o.value,c=null===(r=this.form.get("password"))||void 0===r?void 0:r.value;this.userEmail.update(c,n).subscribe({next:()=>this.onSuccess(n),error:l=>this.onError(l)})}onSuccess(o){this.globalMessageService.add({key:"updateEmailForm.emailUpdateSuccess",params:{newUid:o}},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.authRedirectService.setRedirectUrl(this.routingService.getUrl({cxRoute:"home"})),this.authService.coreLogout().then(()=>{this.routingService.go({cxRoute:"login"},{state:{newUid:o}})})}onError(o){this.busy$.next(!1)}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.PF),e.LFG(s.Znh),e.LFG(s.IWp),e.LFG(s.e80),e.LFG(s.FUY))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),ge=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.save()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(S))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-update-email"]],hostAttrs:[1,"user-form"],decls:31,vars:36,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],[3,"control"],["type","email","name","confirmEmail","formControlName","confirmEmail",1,"form-control",3,"placeholder"],["type","password","name","password","formControlName","password","autocomplete","new-password",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,te,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label"),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"label"),e.TgZ(11,"span",2),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e._UZ(14,"input",5),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",4),e.qZA(),e.TgZ(17,"label"),e.TgZ(18,"span",2),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",6),e.ALo(22,"cxTranslate"),e._UZ(23,"cx-form-errors",4),e.qZA(),e.TgZ(24,"a",7),e.ALo(25,"cxUrl"),e._uU(26),e.ALo(27,"cxTranslate"),e.qZA(),e.TgZ(28,"button",8),e._uU(29),e.ALo(30,"cxTranslate"),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngIf",e.lcZ(1,15,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,17,"updateEmailForm.newEmailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,19,"updateEmailForm.newEmailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("email")),e.xp6(3),e.Oqu(e.lcZ(13,21,"updateEmailForm.confirmNewEmailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(15,23,"updateEmailForm.confirmNewEmailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("confirmEmail")),e.xp6(3),e.Oqu(e.lcZ(20,25,"updateEmailForm.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,27,"updateEmailForm.password.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("password")),e.xp6(1),e.Q6J("routerLink",e.lcZ(25,29,e.DdM(35,T))),e.xp6(2),e.hij(" ",e.lcZ(27,31,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(30,33,"common.save")," "))},directives:[m.O5,i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,d.Ahv,g.yS,d.ORR],pipes:[m.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),t})(),he=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdateEmailComponent:{component:ge,guards:[s.a1M],providers:[{provide:S,useClass:S,deps:[f.PF,s.Znh,s.IWp,s.e80,s.FUY]}]}}})],imports:[[m.ez,i.u5,i.UX,d.Fme,s.bhT,g.Bz,s.LUR,d.Fym]]}),t})(),M=(()=>{class t{constructor(o,r,n){this.userPasswordService=o,this.routingService=r,this.globalMessageService=n,this.busy$=new C.X(!1),this.isUpdating$=this.busy$.pipe((0,Z.b)(c=>!0===c?this.form.disable():this.form.enable())),this.form=new i.cw({oldPassword:new i.NI("",i.kI.required),newPassword:new i.NI("",[i.kI.required,d.kal.passwordValidator]),newPasswordConfirm:new i.NI("",i.kI.required)},{validators:d.kal.passwordsMustMatch("newPassword","newPasswordConfirm")})}updatePassword(){var o,r;if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const n=null===(o=this.form.get("oldPassword"))||void 0===o?void 0:o.value,c=null===(r=this.form.get("newPassword"))||void 0===r?void 0:r.value;this.userPasswordService.update(n,c).subscribe({next:()=>this.onSuccess(),error:l=>this.onError(l)})}onSuccess(){this.globalMessageService.add({key:"updatePasswordForm.passwordUpdateSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.routingService.go({cxRoute:"home"})}onError(o){this.busy$.next(!1),this.form.reset()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),ve=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.updatePassword()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(M))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-update-password"]],hostAttrs:[1,"user-form"],decls:31,vars:36,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["type","password","name","oldPassword","formControlName","oldPassword",1,"form-control",3,"placeholder"],[3,"control"],["type","password","name","newPassword","formControlName","newPassword",1,"form-control",3,"placeholder"],["type","password","name","newPasswordConfirm","formControlName","newPasswordConfirm",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,re,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label"),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"label"),e.TgZ(11,"span",2),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e._UZ(14,"input",5),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",4),e.qZA(),e.TgZ(17,"label"),e.TgZ(18,"span",2),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",6),e.ALo(22,"cxTranslate"),e._UZ(23,"cx-form-errors",4),e.qZA(),e.TgZ(24,"a",7),e.ALo(25,"cxUrl"),e._uU(26),e.ALo(27,"cxTranslate"),e.qZA(),e.TgZ(28,"button",8),e._uU(29),e.ALo(30,"cxTranslate"),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngIf",e.lcZ(1,15,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,17,"updatePasswordForm.oldPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,19,"updatePasswordForm.oldPassword.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("oldPassword")),e.xp6(3),e.Oqu(e.lcZ(13,21,"updatePasswordForm.newPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(15,23,"updatePasswordForm.newPassword.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("newPassword")),e.xp6(3),e.Oqu(e.lcZ(20,25,"updatePasswordForm.confirmPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,27,"updatePasswordForm.confirmPassword.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("newPasswordConfirm")),e.xp6(1),e.Q6J("routerLink",e.lcZ(25,29,e.DdM(35,T))),e.xp6(2),e.hij(" ",e.lcZ(27,31,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(30,33,"common.save")," "))},directives:[m.O5,i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,d.Ahv,g.yS,d.ORR],pipes:[m.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),t})(),Ze=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdatePasswordComponent:{component:ve,guards:[s.a1M],providers:[{provide:M,useClass:M,deps:[f.LL,s.Znh,s.IWp]}]}}})],imports:[[m.ez,i.u5,i.UX,d.Fme,s.LUR,d.Fym,s.bhT,g.Bz]]}),t})(),L=(()=>{class t{constructor(o,r){this.userProfile=o,this.globalMessageService=r,this.user$=this.userProfile.get().pipe((0,R.h)(n=>Boolean(n))),this.busy$=new C.X(!1),this.isUpdating$=this.user$.pipe((0,Z.b)(n=>this.form.patchValue(n)),(0,b.w)(n=>this.busy$),(0,Z.b)(n=>!0===n?this.form.disable():this.form.enable())),this.titles$=this.userProfile.getTitles(),this.form=new i.cw({customerId:new i.NI(""),titleCode:new i.NI(""),firstName:new i.NI("",i.kI.required),lastName:new i.NI("",i.kI.required)})}updateProfile(){this.form.valid?(this.busy$.next(!0),this.userProfile.update(this.form.value).subscribe({next:()=>this.onSuccess(),error:o=>this.onError(o)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessageService.add({key:"updateProfileForm.profileUpdateSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset()}onError(o){this.busy$.next(!1)}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.aT),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),xe=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.titles$=this.service.titles$}onSubmit(){this.service.updateProfile()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(L))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-update-profile"]],hostAttrs:[1,"user-form"],decls:40,vars:42,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["formControlName","titleCode",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text","name","firstName","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["type","text","name","lastName","formControlName","lastName",1,"form-control",3,"placeholder"],["type","text","name","customerId","formControlName","customerId","readonly","",1,"form-control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"],[3,"value"]],template:function(o,r){1&o&&(e.YNc(0,se,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label"),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"select",3),e.TgZ(8,"option",4),e._uU(9),e.ALo(10,"cxTranslate"),e.qZA(),e.YNc(11,ne,2,2,"option",5),e.ALo(12,"async"),e.qZA(),e.qZA(),e.TgZ(13,"label"),e.TgZ(14,"span",2),e._uU(15),e.ALo(16,"cxTranslate"),e.qZA(),e._UZ(17,"input",6),e.ALo(18,"cxTranslate"),e._UZ(19,"cx-form-errors",7),e.qZA(),e.TgZ(20,"label"),e.TgZ(21,"span",2),e._uU(22),e.ALo(23,"cxTranslate"),e.qZA(),e._UZ(24,"input",8),e.ALo(25,"cxTranslate"),e._UZ(26,"cx-form-errors",7),e.qZA(),e.TgZ(27,"label"),e.TgZ(28,"span",2),e._uU(29),e.ALo(30,"cxTranslate"),e.qZA(),e._UZ(31,"input",9),e._UZ(32,"cx-form-errors",7),e.qZA(),e.TgZ(33,"a",10),e.ALo(34,"cxUrl"),e._uU(35),e.ALo(36,"cxTranslate"),e.qZA(),e.TgZ(37,"button",11),e._uU(38),e.ALo(39,"cxTranslate"),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngIf",e.lcZ(1,17,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,19,"updateProfileForm.title")),e.xp6(4),e.Oqu(e.lcZ(10,21,"updateProfileForm.none")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(12,23,r.titles$)),e.xp6(4),e.Oqu(e.lcZ(16,25,"updateProfileForm.firstName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(18,27,"updateProfileForm.firstName.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("firstName")),e.xp6(3),e.Oqu(e.lcZ(23,29,"updateProfileForm.lastName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(25,31,"updateProfileForm.lastName.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("lastName")),e.xp6(3),e.Oqu(e.lcZ(30,33,"updateProfileForm.customerId")),e.xp6(3),e.Q6J("control",r.form.get("lastName")),e.xp6(1),e.Q6J("routerLink",e.lcZ(34,35,e.DdM(41,T))),e.xp6(2),e.hij(" ",e.lcZ(36,37,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(39,39,"common.save")," "))},directives:[m.O5,i._Y,i.JL,i.sg,i.EJ,i.JJ,i.u,i.YN,i.Kr,m.sg,i.Fj,d.Ahv,g.yS,d.ORR],pipes:[m.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),t})(),we=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdateProfileComponent:{component:xe,guards:[s.a1M],providers:[{provide:L,useClass:L,deps:[f.aT,s.IWp]}]}}})],imports:[[m.ez,i.u5,i.UX,d.Fme,s.LUR,d.Fym,g.Bz,s.bhT]]}),t})(),Ce=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[pe,we,he,Ze,de,fe,ce]]}),t})();var Ae=p(5257),N=p(5334),be=p(6710);const k=new e.OlP("UserProfileNormalizer"),Ue=new e.OlP("UserProfileSerializer"),Te=(new e.OlP("UserSerializer"),new e.OlP("UserSignUpSerializer")),_e=new e.OlP("TitleNormalizer");class O{}let U=(()=>{class t{constructor(o){this.userProfileAdapter=o}update(o,r){return this.userProfileAdapter.update(o,r)}register(o){return this.userProfileAdapter.register(o)}registerGuest(o,r){return this.userProfileAdapter.registerGuest(o,r)}requestForgotPasswordEmail(o){return this.userProfileAdapter.requestForgotPasswordEmail(o)}resetPassword(o,r){return this.userProfileAdapter.resetPassword(o,r)}updateEmail(o,r,n){return this.userProfileAdapter.updateEmail(o,r,n)}updatePassword(o,r,n){return this.userProfileAdapter.updatePassword(o,r,n)}remove(o){return this.userProfileAdapter.close(o)}getTitles(){return this.userProfileAdapter.loadTitles()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(O))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),J=(()=>{class t{constructor(o,r,n){this.userIdService=o,this.userProfileConnector=r,this.command=n,this.updateCommand=this.command.create(c=>this.userIdService.takeUserId(!0).pipe((0,b.w)(l=>this.userProfileConnector.updateEmail(l,c.password,c.newUid))),{strategy:s.flE.Queue})}update(o,r){return this.updateCommand.execute({password:o,newUid:r})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(s.XBV),e.LFG(U),e.LFG(s.VDr))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),D=(()=>{class t{constructor(o,r,n){this.userProfileConnector=o,this.userIdService=r,this.command=n,this.updateCommand=this.command.create(c=>this.userIdService.takeUserId(!0).pipe((0,Ae.q)(1),(0,b.w)(l=>this.userProfileConnector.updatePassword(l,c.oldPassword,c.newPassword)))),this.resetCommand=this.command.create(c=>this.userProfileConnector.resetPassword(c.token,c.password)),this.requestForgotPasswordEmailCommand=this.command.create(c=>this.userProfileConnector.requestForgotPasswordEmail(c.email))}update(o,r){return this.updateCommand.execute({oldPassword:o,newPassword:r})}reset(o,r){return this.resetCommand.execute({token:o,password:r})}requestForgotPasswordEmail(o){return this.requestForgotPasswordEmailCommand.execute({email:o})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(U),e.LFG(s.XBV),e.LFG(s.VDr))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),F=(()=>{class t{constructor(o,r,n,c,l,u,v){this.userAccountService=o,this.authService=r,this.userProfileConnector=n,this.eventService=c,this.userIdService=l,this.query=u,this.command=v,this.updateCommand=this.command.create(_=>this.userIdService.takeUserId(!0).pipe((0,b.w)(qe=>this.userProfileConnector.update(qe,_.details).pipe((0,Z.b)(()=>{this.eventService.dispatch({user:_.details},N.x7)})))),{strategy:s.flE.Queue}),this.closeCommand=this.command.create(()=>this.userIdService.takeUserId(!0).pipe((0,b.w)(_=>this.userProfileConnector.remove(_).pipe((0,Z.b)(()=>this.authService.logout()))))),this.titleQuery=this.query.create(()=>this.userProfileConnector.getTitles(),{reloadOn:[s.QRE]})}get(){return this.userAccountService.get()}update(o){return this.updateCommand.execute({details:o})}close(){return this.closeCommand.execute(void 0)}getTitles(){return this.titleQuery.get().pipe((0,A.U)(o=>null!=o?o:[]))}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(N.gf),e.LFG(s.e80),e.LFG(U),e.LFG(s.POd),e.LFG(s.XBV),e.LFG(s._7J),e.LFG(s.VDr))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),$=(()=>{class t{constructor(o,r,n,c,l){this.userProfile=o,this.userConnector=r,this.authService=n,this.command=c,this.store=l,this.registerCommand=this.command.create(({user:u})=>this.userConnector.register(u).pipe((0,Z.b)(()=>{this.store.dispatch(new s.EJN.RegisterUserSuccess)}))),this.registerGuestCommand=this.command.create(u=>this.userConnector.registerGuest(u.guid,u.password).pipe((0,Z.b)(v=>{this.authService.loginWithCredentials(v.uid,u.password)})))}register(o){return this.registerCommand.execute({user:o})}registerGuest(o,r){return this.registerGuestCommand.execute({guid:o,password:r})}getTitles(){return this.userProfile.getTitles()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(F),e.LFG(U),e.LFG(s.e80),e.LFG(s.VDr),e.LFG(be.yh))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();const Pe=[J,D,F,$,{provide:f.PF,useExisting:J},{provide:f.LL,useExisting:D},{provide:f.aT,useExisting:F},{provide:f.zm,useExisting:$}];let ye=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[U,...Pe]}),t})();var h=p(1841),x=p(205),w=p(5304);const Se={backend:{occ:{endpoints:{userRegister:"users",userForgotPassword:"forgottenpasswordtokens",userResetPassword:"resetpassword",userUpdateLoginId:"users/${userId}/login",userUpdatePassword:"users/${userId}/password",titles:"titles"}}}};let Me=(()=>{class t{constructor(o,r,n){this.http=o,this.occEndpoints=r,this.converter=n}update(o,r){const n=this.occEndpoints.isConfigured("userUpdateProfile")?"userUpdateProfile":"user",c=this.occEndpoints.buildUrl(n,{urlParams:{userId:o}});return r=this.converter.convert(r,Ue),this.http.patch(c,r).pipe((0,w.K)(l=>(0,x._)((0,s.cxH)(l))))}register(o){const r=this.occEndpoints.buildUrl("userRegister");let n=new h.WM({"Content-Type":"application/json"});return n=s.Fox.createHeader(s._Re,!0,n),o=this.converter.convert(o,Te),this.http.post(r,o,{headers:n}).pipe((0,w.K)(c=>(0,x._)((0,s.cxH)(c))),this.converter.pipeable(k))}registerGuest(o,r){const n=this.occEndpoints.buildUrl("userRegister");let c=new h.WM({"Content-Type":"application/x-www-form-urlencoded"});c=s.Fox.createHeader(s._Re,!0,c);const l=(new h.LE).set("guid",o).set("password",r);return this.http.post(n,l,{headers:c}).pipe((0,w.K)(u=>(0,x._)((0,s.cxH)(u))),this.converter.pipeable(k))}requestForgotPasswordEmail(o){const r=this.occEndpoints.buildUrl("userForgotPassword"),n=(new h.LE).set("userId",o);let c=new h.WM({"Content-Type":"application/x-www-form-urlencoded"});return c=s.Fox.createHeader(s._Re,!0,c),this.http.post(r,n,{headers:c}).pipe((0,w.K)(l=>(0,x._)((0,s.cxH)(l))))}resetPassword(o,r){const n=this.occEndpoints.buildUrl("userResetPassword");let c=new h.WM({"Content-Type":"application/json"});return c=s.Fox.createHeader(s._Re,!0,c),this.http.post(n,{token:o,newPassword:r},{headers:c}).pipe((0,w.K)(l=>(0,x._)((0,s.cxH)(l))))}updateEmail(o,r,n){const c=this.occEndpoints.buildUrl("userUpdateLoginId",{urlParams:{userId:o}}),l=(new h.LE).set("password",r).set("newLogin",n),u=new h.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.put(c,l,{headers:u}).pipe((0,w.K)(v=>(0,x._)((0,s.cxH)(v))))}updatePassword(o,r,n){const c=this.occEndpoints.buildUrl("userUpdatePassword",{urlParams:{userId:o}}),l=(new h.LE).set("old",r).set("new",n),u=new h.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.put(c,l,{headers:u}).pipe((0,w.K)(v=>(0,x._)((0,s.cxH)(v))))}close(o){const r=this.occEndpoints.isConfigured("userCloseAccount")?"userCloseAccount":"user",n=this.occEndpoints.buildUrl(r,{urlParams:{userId:o}});return this.http.delete(n).pipe((0,w.K)(c=>(0,x._)((0,s.cxH)(c))))}loadTitles(){const o=this.occEndpoints.buildUrl("titles");return this.http.get(o).pipe((0,w.K)(r=>(0,x._)((0,s.cxH)(r))),(0,A.U)(r=>{var n;return null!==(n=r.titles)&&void 0!==n?n:[]}),this.converter.pipeableMany(_e))}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(h.eN),e.LFG(s.Lz0),e.LFG(s.IXI))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Le=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)(Se),{provide:O,useClass:Me}]}),t})(),Fe=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[ye,Le,Ce]]}),t})()}}]);