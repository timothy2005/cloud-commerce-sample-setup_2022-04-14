"use strict";(self.webpackChunkspartacusstore=self.webpackChunkspartacusstore||[]).push([[199],{8199:(G,p,n)=>{n.r(p),n.d(p,{SmartEditModule:()=>D});var r=n(7716),s=n(647),S=n(5435),g=n(5257),C=n(451);let h=(()=>{class t{constructor(e,o,i,c,d,f,u,l){if(this.cmsService=e,this.routingService=o,this.baseSiteService=i,this.zone=c,this.winRef=d,this.rendererFactory=f,this.config=u,this.scriptLoader=l,this.isPreviewPage=!1,this.loadScript(),d.nativeWindow){const v=d.nativeWindow;v.smartedit=v.smartedit||{},v.smartedit.renderComponent=(m,F,M)=>this.renderComponent(m,F,M),v.smartedit.reprocessPage=this.reprocessPage}}processCmsPage(){this.baseSiteService.get().pipe((0,S.h)(e=>Boolean(e)),(0,g.q)(1)).subscribe(e=>{this.defaultPreviewCategoryCode=e.defaultPreviewCategoryCode,this.defaultPreviewProductCode=e.defaultPreviewProductCode,this.cmsService.getCurrentPage().pipe((0,S.h)(Boolean)).subscribe(o=>{this._currentPageId=o.pageId,this.goToPreviewPage(o),this.addPageContract(o)})})}loadScript(){var e;this.scriptLoader.embedScript({src:"assets/webApplicationInjector.js",params:void 0,attributes:{id:"text/smartedit-injector","data-smartedit-allow-origin":null===(e=this.config.smartEdit)||void 0===e?void 0:e.allowOrigin}})}addPageContract(e){const o=this.rendererFactory.createRenderer("body",null),i=this.winRef.document.body,c=[];Array.from(i.classList).forEach(d=>c.push(d)),c.forEach(d=>o.removeClass(i,d)),this.addSmartEditContract(i,o,e.properties)}goToPreviewPage(e){this.isPreviewPage||(this.isPreviewPage=!0,e.type===s.GV4.PRODUCT_PAGE&&this.defaultPreviewProductCode?this.routingService.go({cxRoute:"product",params:{code:this.defaultPreviewProductCode,name:""}}):e.type===s.GV4.CATEGORY_PAGE&&this.defaultPreviewCategoryCode&&this.routingService.go({cxRoute:"category",params:{code:this.defaultPreviewCategoryCode}}))}renderComponent(e,o,i){return e&&this.zone.run(()=>{i?o&&this.cmsService.refreshComponent(e):this._currentPageId?this.cmsService.refreshPageById(this._currentPageId):this.cmsService.refreshLatestPage()}),!0}reprocessPage(){}addSmartEditContract(e,o,i){i&&Object.keys(i).forEach(c=>{const d="data-"+c+"-",f=i[c];Object.keys(f).forEach(u=>{const l=f[u];"classes"===u?l.split(" ").forEach(m=>{o.addClass(e,m)}):o.setAttribute(e,d+u.split(/(?=[A-Z])/).join("-").toLowerCase(),l)})})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(s.ctt),r.LFG(s.Znh),r.LFG(s.Do$),r.LFG(r.R0b),r.LFG(s.X9E),r.LFG(r.FYo),r.LFG(C.Yl),r.LFG(s.Wrh))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const y=[{provide:s.ryK,useExisting:(()=>{class t extends s.ryK{constructor(e){super(),this.smartEditService=e}decorate(e,o,i){i&&this.smartEditService.addSmartEditContract(e,o,i.properties)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(h))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),multi:!0},{provide:s.mR0,useExisting:(()=>{class t extends s.mR0{constructor(e){super(),this.smartEditService=e}decorate(e,o,i){i&&this.smartEditService.addSmartEditContract(e,o,i.properties)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(h))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),multi:!0}];let w=(()=>{class t{constructor(e){this.smartEditService=e,this.smartEditService.processCmsPage()}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(h))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({providers:[...y]}),t})(),D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[w]]}),t})()}}]);