"use strict";(self.webpackChunkspartacusstore=self.webpackChunkspartacusstore||[]).push([[514],{6514:(ne,A,i)=>{i.r(A),i.d(A,{UserAccountModule:()=>oe});var e=i(7716),c=i(3679),r=i(647),a=i(8984),F=i(6215),Z=i(4402),T=i(5917),L=i(8307),I=i(7057),y=i(3190),l=i(8583),d=i(5987),g=i(5334);function D(o,t){1&o&&e._UZ(0,"cx-spinner",8)}const b=function(){return{cxRoute:"forgotPassword"}},R=function(){return{cxRoute:"register"}};function S(o,t){1&o&&(e.ynx(0),e.TgZ(1,"a",3),e.ALo(2,"cxUrl"),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("routerLink",e.lcZ(2,2,e.DdM(6,R))),e.xp6(2),e.Oqu(e.lcZ(4,4,"loginForm.register")))}const O=function(){return{cxRoute:"checkoutLogin"}};function w(o,t){1&o&&(e.ynx(0),e.TgZ(1,"a",4),e.ALo(2,"cxUrl"),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("routerLink",e.lcZ(2,2,e.DdM(6,O))),e.xp6(2),e.Oqu(e.lcZ(4,4,"loginForm.guestCheckout")))}const J=function(o){return{name:o}};function G(o,t){if(1&o&&(e.ynx(0),e.TgZ(1,"div",2),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e._UZ(4,"cx-page-slot",3),e.BQk()),2&o){const n=t.ngIf;e.xp6(2),e.hij(" ",e.xi3(3,1,"miniLogin.userGreeting",e.VKq(4,J,n.name))," ")}}const k=function(){return{cxRoute:"login"}};function B(o,t){1&o&&(e.TgZ(0,"a",4),e.ALo(1,"cxUrl"),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.lcZ(1,2,e.DdM(6,k))),e.xp6(2),e.Oqu(e.lcZ(3,4,"miniLogin.signInRegister")))}let p=(()=>{class o{constructor(n,s,u){this.auth=n,this.globalMessage=s,this.winRef=u,this.busy$=new F.X(!1),this.isUpdating$=this.busy$.pipe((0,L.b)(f=>{var m,v,h;const C=null===(h=null===(v=null===(m=this.winRef.nativeWindow)||void 0===m?void 0:m.history)||void 0===v?void 0:v.state)||void 0===h?void 0:h.newUid;C&&this.form.patchValue({userId:C}),!0===f?this.form.disable():this.form.enable()})),this.form=new c.cw({userId:new c.NI("",[c.kI.required,a.kal.emailValidator]),password:new c.NI("",c.kI.required)})}login(){this.form.valid?(this.busy$.next(!0),(0,Z.D)(this.auth.loginWithCredentials(this.form.value.userId.toLowerCase(),this.form.value.password)).pipe((0,I.M)(this.auth.isUserLoggedIn()),(0,L.b)(([n,s])=>this.onSuccess(s))).subscribe()):this.form.markAllAsTouched()}onSuccess(n){n&&(this.globalMessage.remove(r.xUg.MSG_TYPE_ERROR),this.form.reset()),this.busy$.next(!1)}}return o.\u0275fac=function(n){return new(n||o)(e.LFG(r.e80),e.LFG(r.IWp),e.LFG(r.X9E))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),Q=(()=>{class o{constructor(n){this.service=n,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.style=!0}onSubmit(){this.service.login()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(p))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-login-form"]],hostVars:2,hostBindings:function(n,s){2&n&&e.ekj("user-form",s.style)},decls:24,vars:29,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["type","email","formControlName","userId",1,"form-control",3,"placeholder"],[3,"control"],["type","password","formControlName","password",1,"form-control",3,"placeholder"],["aria-controls","reset-password",1,"btn-link",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(n,s){1&n&&(e.YNc(0,D,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return s.onSubmit()}),e.TgZ(3,"label"),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"label"),e.TgZ(11,"span",2),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e._UZ(14,"input",5),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",4),e.qZA(),e.TgZ(17,"a",6),e.ALo(18,"cxUrl"),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e.TgZ(21,"button",7),e._uU(22),e.ALo(23,"cxTranslate"),e.qZA(),e.qZA()),2&n&&(e.Q6J("ngIf",e.lcZ(1,12,s.isUpdating$)),e.xp6(2),e.Q6J("formGroup",s.form),e.xp6(3),e.Oqu(e.lcZ(6,14,"loginForm.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,16,"loginForm.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",s.form.get("userId")),e.xp6(3),e.Oqu(e.lcZ(13,18,"loginForm.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(15,20,"loginForm.password.placeholder")),e.xp6(2),e.Q6J("control",s.form.get("password")),e.xp6(1),e.Q6J("routerLink",e.lcZ(18,22,e.DdM(28,b))),e.xp6(2),e.Oqu(e.lcZ(20,24,"loginForm.forgotPassword")),e.xp6(2),e.Q6J("disabled",s.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(23,26,"loginForm.signIn")," "))},directives:[l.O5,c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,a.Ahv,d.yS,a.ORR],pipes:[l.Ov,r.X$D,r.l2T],encapsulation:2,changeDetection:0}),o})(),Y=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,r.i51)({cmsComponents:{ReturningCustomerLoginComponent:{component:Q,guards:[r.aOY],providers:[{provide:p,useClass:p,deps:[r.e80,r.IWp,r.X9E]}]}}})],imports:[[l.ez,c.u5,c.UX,d.Bz,r.bhT,r.LUR,a.Fym,a.Fme]]}),o})(),E=(()=>{class o{constructor(n){this.activatedRoute=n,this.loginAsGuest=!1}ngOnInit(){this.loginAsGuest=this.activatedRoute.snapshot.queryParams.forced}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(d.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-login-register"]],decls:6,vars:5,consts:[[1,"register"],[1,"cx-section-title"],[4,"ngIf"],[1,"btn","btn-block","btn-secondary","btn-register",3,"routerLink"],[1,"btn","btn-block","btn-secondary","btn-guest",3,"routerLink"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"p",1),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e.YNc(4,S,5,7,"ng-container",2),e.YNc(5,w,5,7,"ng-container",2),e.qZA()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,3,"loginForm.dontHaveAccount")," "),e.xp6(2),e.Q6J("ngIf",!s.loginAsGuest),e.xp6(1),e.Q6J("ngIf",s.loginAsGuest))},directives:[l.O5,d.yS],pipes:[r.X$D,r.l2T],encapsulation:2}),o})(),N=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,r.i51)({cmsComponents:{ReturningCustomerRegisterComponent:{component:E,guards:[r.aOY]}}})],imports:[[l.ez,d.Bz,r.bhT,a.ISW,r.LUR]]}),o})(),z=(()=>{class o{constructor(n,s){this.auth=n,this.userAccount=s}ngOnInit(){this.user$=this.auth.isUserLoggedIn().pipe((0,y.w)(n=>n?this.userAccount.get():(0,T.of)(void 0)))}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(r.e80),e.Y36(g.gf))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-login"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["login",""],[1,"cx-login-greet"],["position","HeaderLinks"],["role","link",3,"routerLink"]],template:function(n,s){if(1&n&&(e.YNc(0,G,5,6,"ng-container",0),e.ALo(1,"async"),e.YNc(2,B,4,7,"ng-template",null,1,e.W1O)),2&n){const u=e.MAs(3);e.Q6J("ngIf",e.lcZ(1,2,s.user$))("ngIfElse",u)}},directives:[l.O5,a.JSc,d.yS],pipes:[l.Ov,r.X$D,r.l2T],encapsulation:2}),o})(),$=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,r.i51)({cmsComponents:{LoginComponent:{component:z}}})],imports:[[l.ez,d.Bz,r.bhT,a.ISW,r.LUR]]}),o})(),j=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[$,Y,N]]}),o})();const X=new e.OlP("UserAccountNormalizer");new e.OlP("UserAccountSerializer");class U{}let M=(()=>{class o{constructor(n){this.adapter=n}get(n){return this.adapter.load(n)}}return o.\u0275fac=function(n){return new(n||o)(e.LFG(U))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),x=(()=>{class o{constructor(n,s,u){this.userAccountConnector=n,this.userIdService=s,this.query=u,this.userQuery=this.query.create(()=>this.userIdService.takeUserId(!0).pipe((0,y.w)(f=>this.userAccountConnector.get(f))),{reloadOn:[g.x7],resetOn:[r.p1J,r.rX_]})}get(){return this.userQuery.get()}}return o.\u0275fac=function(n){return new(n||o)(e.LFG(M),e.LFG(r.XBV),e.LFG(r._7J))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();const q=[x,{provide:g.gf,useExisting:x}];let P=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[M,...q]}),o})();var W=i(205),V=i(5304),H=i(1841);const K={backend:{occ:{endpoints:{user:"users/${userId}"}}}};let _=(()=>{class o{constructor(n,s,u){this.http=n,this.occEndpoints=s,this.converter=u}load(n){const s=this.occEndpoints.buildUrl("user",{urlParams:{userId:n}});return this.http.get(s).pipe((0,V.K)(u=>(0,W._)((0,r.cxH)(u))),this.converter.pipeable(X))}}return o.\u0275fac=function(n){return new(n||o)(e.LFG(H.eN),e.LFG(r.Lz0),e.LFG(r.IXI))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),ee=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,r.i51)(K),{provide:U,useClass:_}]}),o})(),oe=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[P,ee,j]]}),o})()}}]);