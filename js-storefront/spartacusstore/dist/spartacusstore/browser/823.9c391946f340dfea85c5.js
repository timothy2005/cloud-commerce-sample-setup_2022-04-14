"use strict";(self.webpackChunkspartacusstore=self.webpackChunkspartacusstore||[]).push([[823],{8823:(E,g,s)=>{s.r(g),s.d(g,{ProductVariantsModule:()=>N});var t=s(7716),u=s(8583),a=s(647);const V={backend:{occ:{endpoints:{product:{variants:"products/${productCode}?fields=name,purchasable,baseOptions(DEFAULT),baseProduct,variantOptions(DEFAULT),variantType"}}}}};let y=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,a.i51)(V)],imports:[[u.ez]]}),n})();var v=s(5987),p=s(5435),f=s(5257),P=s(7519),_=s(8307),x=s(3190),T=s(8002),M=s(8984),m=s(5917);function O(n,r){if(1&n&&(t.TgZ(0,"option",4),t._uU(1),t.qZA()),2&n){const e=r.$implicit,o=t.oxw();t.s9C("value",e.code),t.Q6J("selected",e.code===(null==o.product?null:o.product.code)),t.xp6(1),t.hij(" ",o.getVariantOptionValue(e.variantOptionQualifiers)," ")}}function Z(n,r){if(1&n&&(t.TgZ(0,"option",5),t._uU(1),t.qZA()),2&n){const e=r.$implicit,o=t.oxw();t.s9C("value",e.code),t.Q6J("selected",e.code===(null==o.product?null:o.product.code)),t.xp6(1),t.hij(" ",o.getVariantOptionValue(e.variantOptionQualifiers)," ")}}function z(n,r){if(1&n&&(t.TgZ(0,"div",4),t._uU(1),t.ALo(2,"cxTranslate"),t.TgZ(3,"span",5),t._uU(4),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,2,"productVariants.style"),": "),t.xp6(3),t.Oqu(e.getVariantOptionValue(null==e.variants?null:e.variants.selected.variantOptionQualifiers))}}const D=function(n){return{"selected-variant":n}};function A(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"li",6),t.TgZ(1,"button",7),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().changeStyle(c.code)}),t._UZ(2,"img",8),t.qZA(),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw();t.Q6J("ngClass",t.VKq(4,D,e.code===(null==o.variants||null==o.variants.selected?null:o.variants.selected.code))),t.xp6(2),t.s9C("src",o.getVariantThumbnailUrl(e.variantOptionQualifiers),t.LSH),t.s9C("title",o.getVariantOptionValue(e.variantOptionQualifiers)),t.s9C("alt",o.getVariantOptionValue(e.variantOptionQualifiers))}}function F(n,r){if(1&n&&t._UZ(0,"cx-product-variant-style-selector",5),2&n){const e=t.oxw(3);t.Q6J("variants",e.variants[e.variantType.STYLE])}}function J(n,r){if(1&n&&t._UZ(0,"cx-product-variant-size-selector",6),2&n){const e=t.oxw(2).ngIf,o=t.oxw();t.Q6J("product",e)("variants",o.variants[o.variantType.SIZE])}}function Q(n,r){if(1&n&&t._UZ(0,"cx-product-variant-color-selector",6),2&n){const e=t.oxw(2).ngIf,o=t.oxw();t.Q6J("product",e)("variants",o.variants[o.variantType.COLOR])}}function L(n,r){if(1&n&&(t.TgZ(0,"div",2),t.YNc(1,F,1,1,"cx-product-variant-style-selector",3),t.YNc(2,J,1,2,"cx-product-variant-size-selector",4),t.YNc(3,Q,1,2,"cx-product-variant-color-selector",4),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.variants[e.variantType.STYLE]),t.xp6(1),t.Q6J("ngIf",e.variants[e.variantType.SIZE]),t.xp6(1),t.Q6J("ngIf",e.variants[e.variantType.COLOR])}}function b(n,r){if(1&n&&(t.ynx(0),t.YNc(1,L,4,3,"div",1),t.BQk()),2&n){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",null==e.baseOptions?null:e.baseOptions.length)}}let Y=(()=>{class n{constructor(e){this.routingService=e}changeColor(e,o){return e&&this.routingService.go({cxRoute:"product",params:{code:e,name:o}}),null}getVariantOptionValue(e){const o=e.find(i=>i.qualifier===a.zYO.COLOR);return o?o.value:""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.Znh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-product-variant-color-selector"]],inputs:{product:"product",variants:"variants"},decls:7,vars:4,consts:[[1,"variant-selector"],[1,"variant-name"],[1,"form-control","variant-select",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],[3,"value","selected"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t._uU(3),t.ALo(4,"cxTranslate"),t.qZA(),t.TgZ(5,"select",2),t.NdJ("change",function(c){return o.changeColor(c.target.value,null==o.product?null:o.product.name)}),t.YNc(6,O,2,3,"option",3),t.qZA(),t.qZA(),t.BQk()),2&e&&(t.xp6(3),t.hij("",t.lcZ(4,2,"productVariants.color"),":"),t.xp6(3),t.Q6J("ngForOf",null==o.variants?null:o.variants.options))},directives:[u.sg],pipes:[a.X$D],encapsulation:2,changeDetection:0}),n})(),S=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,v.Bz,a.bhT,a.LUR]]}),n})(),U=(()=>{class n{constructor(e,o){this.productService=e,this.routingService=o}changeSize(e){return e&&this.productService.get(e,"list").pipe((0,p.h)(o=>!!o),(0,f.q)(1)).subscribe(o=>{this.routingService.go({cxRoute:"product",params:o})}),null}getVariantOptionValue(e){const o=e.find(i=>i.qualifier===a.zYO.SIZE);return o?o.value:""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.M52),t.Y36(a.Znh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-product-variant-size-selector"]],inputs:{product:"product",variants:"variants"},decls:11,vars:10,consts:[[1,"variant-selector"],[1,"variant-name"],[1,"form-control","variant-select",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["href","#",1,"size-guide",3,"title"],[3,"value","selected"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t._uU(3),t.ALo(4,"cxTranslate"),t.qZA(),t.TgZ(5,"select",2),t.NdJ("change",function(c){return o.changeSize(c.target.value)}),t.YNc(6,Z,2,3,"option",3),t.qZA(),t.TgZ(7,"a",4),t.ALo(8,"cxTranslate"),t._uU(9),t.ALo(10,"cxTranslate"),t.qZA(),t.qZA(),t.BQk()),2&e&&(t.xp6(3),t.hij("",t.lcZ(4,4,"productVariants.size"),":"),t.xp6(3),t.Q6J("ngForOf",null==o.variants?null:o.variants.options),t.xp6(1),t.s9C("title",t.lcZ(8,6,"productVariants.sizeGuideLabel")),t.xp6(2),t.hij(" ",t.lcZ(10,8,"productVariants.sizeGuideLabel")," "))},directives:[u.sg],pipes:[a.X$D],encapsulation:2,changeDetection:0}),n})(),h=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,v.Bz,a.bhT,a.LUR]]}),n})(),I=(()=>{class n{constructor(e,o,i){this.config=e,this.productService=o,this.routingService=i,this.variantQualifier=a.zYO}getVariantOptionValue(e){const o=e.find(i=>i.qualifier===a.zYO.STYLE);return o?o.value:""}getVariantThumbnailUrl(e){var o,i,c,l;const d=e.find($=>$.image);return d?`${null===(c=null===(i=null===(o=this.config)||void 0===o?void 0:o.backend)||void 0===i?void 0:i.occ)||void 0===c?void 0:c.baseUrl}${null===(l=d.image)||void 0===l?void 0:l.url}`:""}changeStyle(e){return e&&this.productService.get(e,"list").pipe((0,p.h)(o=>!!o),(0,f.q)(1)).subscribe(o=>{this.routingService.go({cxRoute:"product",params:o})}),null}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.Vri),t.Y36(a.M52),t.Y36(a.Znh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-product-variant-style-selector"]],inputs:{variants:"variants"},decls:5,vars:2,consts:[[1,"variant-selector"],["class","variant-name",4,"ngIf"],[1,"variant-list"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"variant-name"],[1,"style-name"],[3,"ngClass"],[1,"variant-button",3,"click"],[3,"src","title","alt"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,z,5,4,"div",1),t.TgZ(3,"ul",2),t.YNc(4,A,3,6,"li",3),t.qZA(),t.qZA(),t.BQk()),2&e&&(t.xp6(2),t.Q6J("ngIf",o.variants.selected),t.xp6(2),t.Q6J("ngForOf",null==o.variants?null:o.variants.options))},directives:[u.O5,u.sg,u.mk],pipes:[a.X$D],encapsulation:2,changeDetection:0}),n})(),C=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,v.Bz,a.bhT,a.LUR]]}),n})(),j=(()=>{class n{constructor(e){this.currentProductService=e,this.variants={},this.variantType=a.JyF}ngOnInit(){this.product$=this.currentProductService.getProduct().pipe((0,p.h)(a.jWE),(0,p.h)(e=>!!e.baseOptions),(0,P.x)(),(0,_.b)(e=>{e.baseOptions.forEach(o=>{(null==o?void 0:o.variantType)&&(this.variants[o.variantType]=o)})}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.pHG))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-product-variants-container"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","variant-section",4,"ngIf"],[1,"variant-section"],[3,"variants",4,"ngIf"],[3,"product","variants",4,"ngIf"],[3,"variants"],[3,"product","variants"]],template:function(e,o){1&e&&(t.YNc(0,b,2,1,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.product$))},directives:[u.O5,I,U,Y],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})(),B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,v.Bz,a.bhT,a.LUR,C,h,S]]}),n})(),w=(()=>{class n{constructor(e,o,i){this.productService=e,this.semanticPathService=o,this.router=i}canActivate(e){var o;const i=null===(o=e.params)||void 0===o?void 0:o.productCode;return i?this.productService.get(i,"variants").pipe((0,p.h)(c=>!!c),(0,x.w)(c=>{if(!c.purchasable){const l=this.findPurchasableProductCode(c);if(l)return this.productService.get(l,"list").pipe((0,p.h)(d=>!!d),(0,f.q)(1),(0,T.U)(d=>this.router.createUrlTree(this.semanticPathService.transform({cxRoute:"product",params:d}))))}return(0,m.of)(!0)})):(0,m.of)(!0)}findPurchasableProductCode(e){var o,i,c;if(null===(o=e.variantOptions)||void 0===o?void 0:o.length){const l=e.variantOptions.filter(d=>!(!d.stock||!d.stock.stockLevel)&&d);return l&&l.length?null===(i=l[0])||void 0===i?void 0:i.code:null===(c=e.variantOptions[0])||void 0===c?void 0:c.code}}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(a.M52),t.LFG(a.hCH),t.LFG(v.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,a.i51)({cmsComponents:{ProductVariantSelectorComponent:{component:j,guards:[w]}}})],imports:[[B,S,h,C]]}),n})(),N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[y,q]]}),n})()}}]);