"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=514,exports.ids=[514],exports.modules={6514:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{UserAccountModule:()=>UserAccountModule});var core=__webpack_require__(7716),fesm2015_forms=__webpack_require__(3679),spartacus_core=__webpack_require__(1018),spartacus_storefront=__webpack_require__(9667),BehaviorSubject=__webpack_require__(6215),from=__webpack_require__(4402),of=__webpack_require__(5917),tap=__webpack_require__(8307),withLatestFrom=__webpack_require__(7057),switchMap=__webpack_require__(3190),common=__webpack_require__(8583),router=__webpack_require__(5987),spartacus_user_account_root=__webpack_require__(5334);function LoginFormComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",8)}__name(LoginFormComponent_cx_spinner_0_Template,"LoginFormComponent_cx_spinner_0_Template");const _c0=__name(function(){return{cxRoute:"forgotPassword"}},"_c0"),_c1=__name(function(){return{cxRoute:"register"}},"_c1");function LoginRegisterComponent_ng_container_4_Template(rf,ctx){1&rf&&(core.ynx(0),core.TgZ(1,"a",3),core.ALo(2,"cxUrl"),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA(),core.BQk()),2&rf&&(core.xp6(1),core.Q6J("routerLink",core.lcZ(2,2,core.DdM(6,_c1))),core.xp6(2),core.Oqu(core.lcZ(4,4,"loginForm.register")))}__name(LoginRegisterComponent_ng_container_4_Template,"LoginRegisterComponent_ng_container_4_Template");const _c2=__name(function(){return{cxRoute:"checkoutLogin"}},"_c2");function LoginRegisterComponent_ng_container_5_Template(rf,ctx){1&rf&&(core.ynx(0),core.TgZ(1,"a",4),core.ALo(2,"cxUrl"),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA(),core.BQk()),2&rf&&(core.xp6(1),core.Q6J("routerLink",core.lcZ(2,2,core.DdM(6,_c2))),core.xp6(2),core.Oqu(core.lcZ(4,4,"loginForm.guestCheckout")))}__name(LoginRegisterComponent_ng_container_5_Template,"LoginRegisterComponent_ng_container_5_Template");const _c3=__name(function(a0){return{name:a0}},"_c3");function LoginComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.TgZ(1,"div",2),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA(),core._UZ(4,"cx-page-slot",3),core.BQk()),2&rf){const user_r3=ctx.ngIf;core.xp6(2),core.hij(" ",core.xi3(3,1,"miniLogin.userGreeting",core.VKq(4,_c3,user_r3.name))," ")}}__name(LoginComponent_ng_container_0_Template,"LoginComponent_ng_container_0_Template");const _c4=__name(function(){return{cxRoute:"login"}},"_c4");function LoginComponent_ng_template_2_Template(rf,ctx){1&rf&&(core.TgZ(0,"a",4),core.ALo(1,"cxUrl"),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA()),2&rf&&(core.Q6J("routerLink",core.lcZ(1,2,core.DdM(6,_c4))),core.xp6(2),core.Oqu(core.lcZ(3,4,"miniLogin.signInRegister")))}__name(LoginComponent_ng_template_2_Template,"LoginComponent_ng_template_2_Template");class LoginFormComponentService{constructor(auth,globalMessage,winRef){this.auth=auth,this.globalMessage=globalMessage,this.winRef=winRef,this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.busy$.pipe((0,tap.b)(state=>{var _a,_b,_c;const userId=null===(_c=null===(_b=null===(_a=this.winRef.nativeWindow)||void 0===_a?void 0:_a.history)||void 0===_b?void 0:_b.state)||void 0===_c?void 0:_c.newUid;userId&&this.form.patchValue({userId}),!0===state?this.form.disable():this.form.enable()})),this.form=new fesm2015_forms.cw({userId:new fesm2015_forms.NI("",[fesm2015_forms.kI.required,spartacus_storefront.kal.emailValidator]),password:new fesm2015_forms.NI("",fesm2015_forms.kI.required)})}login(){this.form.valid?(this.busy$.next(!0),(0,from.D)(this.auth.loginWithCredentials(this.form.value.userId.toLowerCase(),this.form.value.password)).pipe((0,withLatestFrom.M)(this.auth.isUserLoggedIn()),(0,tap.b)(([_,isLoggedIn])=>this.onSuccess(isLoggedIn))).subscribe()):this.form.markAllAsTouched()}onSuccess(isLoggedIn){isLoggedIn&&(this.globalMessage.remove(spartacus_core.xUg.MSG_TYPE_ERROR),this.form.reset()),this.busy$.next(!1)}}__name(LoginFormComponentService,"LoginFormComponentService"),LoginFormComponentService.\u0275fac=__name(function(t){return new(t||LoginFormComponentService)(core.LFG(spartacus_core.e80),core.LFG(spartacus_core.IWp),core.LFG(spartacus_core.X9E))},"LoginFormComponentService_Factory"),LoginFormComponentService.\u0275prov=core.Yz7({token:LoginFormComponentService,factory:LoginFormComponentService.\u0275fac});class LoginFormComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.style=!0}onSubmit(){this.service.login()}}__name(LoginFormComponent,"LoginFormComponent"),LoginFormComponent.\u0275fac=__name(function(t){return new(t||LoginFormComponent)(core.Y36(LoginFormComponentService))},"LoginFormComponent_Factory"),LoginFormComponent.\u0275cmp=core.Xpm({type:LoginFormComponent,selectors:[["cx-login-form"]],hostVars:2,hostBindings:__name(function(rf,ctx){2&rf&&core.ekj("user-form",ctx.style)},"LoginFormComponent_HostBindings"),decls:24,vars:29,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["type","email","formControlName","userId",1,"form-control",3,"placeholder"],[3,"control"],["type","password","formControlName","password",1,"form-control",3,"placeholder"],["aria-controls","reset-password",1,"btn-link",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,LoginFormComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.TgZ(2,"form",1),core.NdJ("ngSubmit",__name(function(){return ctx.onSubmit()},"LoginFormComponent_Template_form_ngSubmit_2_listener")),core.TgZ(3,"label"),core.TgZ(4,"span",2),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core._UZ(7,"input",3),core.ALo(8,"cxTranslate"),core._UZ(9,"cx-form-errors",4),core.qZA(),core.TgZ(10,"label"),core.TgZ(11,"span",2),core._uU(12),core.ALo(13,"cxTranslate"),core.qZA(),core._UZ(14,"input",5),core.ALo(15,"cxTranslate"),core._UZ(16,"cx-form-errors",4),core.qZA(),core.TgZ(17,"a",6),core.ALo(18,"cxUrl"),core._uU(19),core.ALo(20,"cxTranslate"),core.qZA(),core.TgZ(21,"button",7),core._uU(22),core.ALo(23,"cxTranslate"),core.qZA(),core.qZA()),2&rf&&(core.Q6J("ngIf",core.lcZ(1,12,ctx.isUpdating$)),core.xp6(2),core.Q6J("formGroup",ctx.form),core.xp6(3),core.Oqu(core.lcZ(6,14,"loginForm.emailAddress.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(8,16,"loginForm.emailAddress.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("userId")),core.xp6(3),core.Oqu(core.lcZ(13,18,"loginForm.password.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(15,20,"loginForm.password.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("password")),core.xp6(1),core.Q6J("routerLink",core.lcZ(18,22,core.DdM(28,_c0))),core.xp6(2),core.Oqu(core.lcZ(20,24,"loginForm.forgotPassword")),core.xp6(2),core.Q6J("disabled",ctx.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(23,26,"loginForm.signIn")," "))},"LoginFormComponent_Template"),directives:[common.O5,fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.sg,fesm2015_forms.Fj,fesm2015_forms.JJ,fesm2015_forms.u,spartacus_storefront.Ahv,router.yS,spartacus_storefront.ORR],pipes:[common.Ov,spartacus_core.X$D,spartacus_core.l2T],encapsulation:2,changeDetection:0});class LoginFormModule{}__name(LoginFormModule,"LoginFormModule"),LoginFormModule.\u0275fac=__name(function(t){return new(t||LoginFormModule)},"LoginFormModule_Factory"),LoginFormModule.\u0275mod=core.oAB({type:LoginFormModule}),LoginFormModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ReturningCustomerLoginComponent:{component:LoginFormComponent,guards:[spartacus_core.aOY],providers:[{provide:LoginFormComponentService,useClass:LoginFormComponentService,deps:[spartacus_core.e80,spartacus_core.IWp,spartacus_core.X9E]}]}}})],imports:[[common.ez,fesm2015_forms.u5,fesm2015_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Fme]]});class LoginRegisterComponent{constructor(activatedRoute){this.activatedRoute=activatedRoute,this.loginAsGuest=!1}ngOnInit(){this.loginAsGuest=this.activatedRoute.snapshot.queryParams.forced}}__name(LoginRegisterComponent,"LoginRegisterComponent"),LoginRegisterComponent.\u0275fac=__name(function(t){return new(t||LoginRegisterComponent)(core.Y36(router.gz))},"LoginRegisterComponent_Factory"),LoginRegisterComponent.\u0275cmp=core.Xpm({type:LoginRegisterComponent,selectors:[["cx-login-register"]],decls:6,vars:5,consts:[[1,"register"],[1,"cx-section-title"],[4,"ngIf"],[1,"btn","btn-block","btn-secondary","btn-register",3,"routerLink"],[1,"btn","btn-block","btn-secondary","btn-guest",3,"routerLink"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0),core.TgZ(1,"p",1),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA(),core.YNc(4,LoginRegisterComponent_ng_container_4_Template,5,7,"ng-container",2),core.YNc(5,LoginRegisterComponent_ng_container_5_Template,5,7,"ng-container",2),core.qZA()),2&rf&&(core.xp6(2),core.hij(" ",core.lcZ(3,3,"loginForm.dontHaveAccount")," "),core.xp6(2),core.Q6J("ngIf",!ctx.loginAsGuest),core.xp6(1),core.Q6J("ngIf",ctx.loginAsGuest))},"LoginRegisterComponent_Template"),directives:[common.O5,router.yS],pipes:[spartacus_core.X$D,spartacus_core.l2T],encapsulation:2});class LoginRegisterModule{}__name(LoginRegisterModule,"LoginRegisterModule"),LoginRegisterModule.\u0275fac=__name(function(t){return new(t||LoginRegisterModule)},"LoginRegisterModule_Factory"),LoginRegisterModule.\u0275mod=core.oAB({type:LoginRegisterModule}),LoginRegisterModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ReturningCustomerRegisterComponent:{component:LoginRegisterComponent,guards:[spartacus_core.aOY]}}})],imports:[[common.ez,router.Bz,spartacus_core.bhT,spartacus_storefront.ISW,spartacus_core.LUR]]});class LoginComponent{constructor(auth,userAccount){this.auth=auth,this.userAccount=userAccount}ngOnInit(){this.user$=this.auth.isUserLoggedIn().pipe((0,switchMap.w)(isUserLoggedIn=>isUserLoggedIn?this.userAccount.get():(0,of.of)(void 0)))}}__name(LoginComponent,"LoginComponent"),LoginComponent.\u0275fac=__name(function(t){return new(t||LoginComponent)(core.Y36(spartacus_core.e80),core.Y36(spartacus_user_account_root.gf))},"LoginComponent_Factory"),LoginComponent.\u0275cmp=core.Xpm({type:LoginComponent,selectors:[["cx-login"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["login",""],[1,"cx-login-greet"],["position","HeaderLinks"],["role","link",3,"routerLink"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,LoginComponent_ng_container_0_Template,5,6,"ng-container",0),core.ALo(1,"async"),core.YNc(2,LoginComponent_ng_template_2_Template,4,7,"ng-template",null,1,core.W1O)),2&rf){const _r1=core.MAs(3);core.Q6J("ngIf",core.lcZ(1,2,ctx.user$))("ngIfElse",_r1)}},"LoginComponent_Template"),directives:[common.O5,spartacus_storefront.JSc,router.yS],pipes:[common.Ov,spartacus_core.X$D,spartacus_core.l2T],encapsulation:2});class LoginModule{}__name(LoginModule,"LoginModule"),LoginModule.\u0275fac=__name(function(t){return new(t||LoginModule)},"LoginModule_Factory"),LoginModule.\u0275mod=core.oAB({type:LoginModule}),LoginModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{LoginComponent:{component:LoginComponent}}})],imports:[[common.ez,router.Bz,spartacus_core.bhT,spartacus_storefront.ISW,spartacus_core.LUR]]});class UserAccountComponentsModule{}__name(UserAccountComponentsModule,"UserAccountComponentsModule"),UserAccountComponentsModule.\u0275fac=__name(function(t){return new(t||UserAccountComponentsModule)},"UserAccountComponentsModule_Factory"),UserAccountComponentsModule.\u0275mod=core.oAB({type:UserAccountComponentsModule}),UserAccountComponentsModule.\u0275inj=core.cJS({imports:[[LoginModule,LoginFormModule,LoginRegisterModule]]});const USER_ACCOUNT_NORMALIZER=new core.OlP("UserAccountNormalizer");new core.OlP("UserAccountSerializer");class UserAccountAdapter{}__name(UserAccountAdapter,"UserAccountAdapter");class UserAccountConnector{constructor(adapter){this.adapter=adapter}get(userId){return this.adapter.load(userId)}}__name(UserAccountConnector,"UserAccountConnector"),UserAccountConnector.\u0275fac=__name(function(t){return new(t||UserAccountConnector)(core.LFG(UserAccountAdapter))},"UserAccountConnector_Factory"),UserAccountConnector.\u0275prov=core.Yz7({token:UserAccountConnector,factory:UserAccountConnector.\u0275fac});class UserAccountService{constructor(userAccountConnector,userIdService,query){this.userAccountConnector=userAccountConnector,this.userIdService=userIdService,this.query=query,this.userQuery=this.query.create(()=>this.userIdService.takeUserId(!0).pipe((0,switchMap.w)(userId=>this.userAccountConnector.get(userId))),{reloadOn:[spartacus_user_account_root.x7],resetOn:[spartacus_core.p1J,spartacus_core.rX_]})}get(){return this.userQuery.get()}}__name(UserAccountService,"UserAccountService"),UserAccountService.\u0275fac=__name(function(t){return new(t||UserAccountService)(core.LFG(UserAccountConnector),core.LFG(spartacus_core.XBV),core.LFG(spartacus_core._7J))},"UserAccountService_Factory"),UserAccountService.\u0275prov=core.Yz7({token:UserAccountService,factory:UserAccountService.\u0275fac});const facadeProviders=[UserAccountService,{provide:spartacus_user_account_root.gf,useExisting:UserAccountService}];class UserAccountCoreModule{}__name(UserAccountCoreModule,"UserAccountCoreModule"),UserAccountCoreModule.\u0275fac=__name(function(t){return new(t||UserAccountCoreModule)},"UserAccountCoreModule_Factory"),UserAccountCoreModule.\u0275mod=core.oAB({type:UserAccountCoreModule}),UserAccountCoreModule.\u0275inj=core.cJS({providers:[UserAccountConnector,...facadeProviders]});var throwError=__webpack_require__(205),catchError=__webpack_require__(5304),http=__webpack_require__(1841);class OccUserAccountAdapter{constructor(http2,occEndpoints,converter){this.http=http2,this.occEndpoints=occEndpoints,this.converter=converter}load(userId){const url=this.occEndpoints.buildUrl("user",{urlParams:{userId}});return this.http.get(url).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))),this.converter.pipeable(USER_ACCOUNT_NORMALIZER))}}__name(OccUserAccountAdapter,"OccUserAccountAdapter"),OccUserAccountAdapter.\u0275fac=__name(function(t){return new(t||OccUserAccountAdapter)(core.LFG(http.eN),core.LFG(spartacus_core.Lz0),core.LFG(spartacus_core.IXI))},"OccUserAccountAdapter_Factory"),OccUserAccountAdapter.\u0275prov=core.Yz7({token:OccUserAccountAdapter,factory:OccUserAccountAdapter.\u0275fac});class UserAccountOccModule{}__name(UserAccountOccModule,"UserAccountOccModule"),UserAccountOccModule.\u0275fac=__name(function(t){return new(t||UserAccountOccModule)},"UserAccountOccModule_Factory"),UserAccountOccModule.\u0275mod=core.oAB({type:UserAccountOccModule}),UserAccountOccModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({backend:{occ:{endpoints:{user:"users/${userId}"}}}}),{provide:UserAccountAdapter,useClass:OccUserAccountAdapter}]});class UserAccountModule{}__name(UserAccountModule,"UserAccountModule"),UserAccountModule.\u0275fac=__name(function(t){return new(t||UserAccountModule)},"UserAccountModule_Factory"),UserAccountModule.\u0275mod=core.oAB({type:UserAccountModule}),UserAccountModule.\u0275inj=core.cJS({imports:[[UserAccountCoreModule,UserAccountOccModule,UserAccountComponentsModule]]})}};